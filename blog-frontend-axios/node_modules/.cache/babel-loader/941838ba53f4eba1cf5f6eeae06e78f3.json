{"ast":null,"code":"import _objectWithoutProperties from \"F:\\\\Documents\\\\Documents\\\\_Nest\\\\nest-react-blog-marc\\\\blog-frontend-axios\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport API, { TOKEN_KEY, setToken } from './APIUtils';\nimport { setLocalStorage } from '../../utils/utils';\n\nfunction handleUserData(_ref) {\n  let _ref$user = _ref.user,\n      token = _ref$user.token,\n      user = _objectWithoutProperties(_ref$user, [\"token\"]);\n\n  setLocalStorage(TOKEN_KEY, token);\n  setToken(token);\n  return user;\n}\n\nfunction getCurrentUser() {\n  return API.get('/auth/user');\n}\n\nfunction login(email, password) {\n  return API.post('/auth/login', {\n    user: {\n      email,\n      password\n    }\n  }).then(response => handleUserData(response.data));\n}\n\nfunction register(username, email, password) {\n  const user = {\n    username,\n    email,\n    password\n  };\n  return API.post('/auth/register', {\n    userAPI\n  }).then(response => handleUserData(response.data)).catch(error => {\n    console.log(error);\n  });\n}\n\nfunction logout() {\n  localStorage.removeItem(TOKEN_KEY);\n  setToken(null);\n}\n\nconst AUTHAPI = {\n  getCurrentUser,\n  login,\n  register,\n  logout\n};\nexport default AUTHAPI;","map":{"version":3,"sources":["F:/Documents/Documents/_Nest/nest-react-blog-marc/blog-frontend-axios/src/services/api/AuthAPI.ts"],"names":["API","TOKEN_KEY","setToken","setLocalStorage","handleUserData","user","token","getCurrentUser","get","login","email","password","post","then","response","data","register","username","userAPI","catch","error","console","log","logout","localStorage","removeItem","AUTHAPI"],"mappings":";AAAA,OAAOA,GAAP,IAAcC,SAAd,EAA0BC,QAA1B,QAA0C,YAA1C;AAEA,SAASC,eAAT,QAAgC,mBAAhC;;AAMA,SAASC,cAAT,OAA4D;AAAA,uBAAlCC,IAAkC;AAAA,MAA1BC,KAA0B,aAA1BA,KAA0B;AAAA,MAAhBD,IAAgB;;AAC1DF,EAAAA,eAAe,CAACF,SAAD,EAAYK,KAAZ,CAAf;AACAJ,EAAAA,QAAQ,CAACI,KAAD,CAAR;AACA,SAAOD,IAAP;AACD;;AAED,SAASE,cAAT,GAA0B;AACxB,SAAOP,GAAG,CAACQ,GAAJ,CAAc,YAAd,CAAP;AACD;;AAED,SAASC,KAAT,CAAeC,KAAf,EAA8BC,QAA9B,EAAgD;AAC9C,SAAOX,GAAG,CAACY,IAAJ,CAAe,aAAf,EAA8B;AACnCP,IAAAA,IAAI,EAAE;AAAEK,MAAAA,KAAF;AAASC,MAAAA;AAAT;AAD6B,GAA9B,EAEJE,IAFI,CAEEC,QAAD,IAAcV,cAAc,CAACU,QAAQ,CAACC,IAAV,CAF7B,CAAP;AAGD;;AAED,SAASC,QAAT,CACEC,QADF,EAEEP,KAFF,EAGEC,QAHF,EAIkB;AAChB,QAAMN,IAAU,GAAG;AAACY,IAAAA,QAAD;AAAWP,IAAAA,KAAX;AAAkBC,IAAAA;AAAlB,GAAnB;AACA,SAAOX,GAAG,CAACY,IAAJ,CAAe,gBAAf,EAAiC;AAAEM,IAAAA;AAAF,GAAjC,EACJL,IADI,CACEC,QAAD,IAAcV,cAAc,CAACU,QAAQ,CAACC,IAAV,CAD7B,EAGNI,KAHM,CAGCC,KAAD,IAAW;AAChBC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD,GALM,CAAP;AAMD;;AAED,SAASG,MAAT,GAAkB;AAChBC,EAAAA,YAAY,CAACC,UAAb,CAAwBxB,SAAxB;AACAC,EAAAA,QAAQ,CAAC,IAAD,CAAR;AACD;;AAED,MAAMwB,OAAO,GAAG;AAACnB,EAAAA,cAAD;AAAiBE,EAAAA,KAAjB;AAAwBO,EAAAA,QAAxB;AAAkCO,EAAAA;AAAlC,CAAhB;AAEA,eAAeG,OAAf","sourcesContent":["import API, { TOKEN_KEY , setToken } from './APIUtils';\r\nimport { IUser } from '../../types';\r\nimport { setLocalStorage } from '../../utils/utils';\r\n\r\ntype User = {\r\n  user: IUser & { token: string };\r\n};\r\n\r\nfunction handleUserData({ user: { token, ...user } }: User) {\r\n  setLocalStorage(TOKEN_KEY, token);\r\n  setToken(token);\r\n  return user;\r\n}\r\n\r\nfunction getCurrentUser() {\r\n  return API.get<User>('/auth/user');\r\n}\r\n\r\nfunction login(email: string, password: string) {\r\n  return API.post<User>('/auth/login', {\r\n    user: { email, password },\r\n  }).then((response) => handleUserData(response.data));\r\n}\r\n\r\nfunction register(\r\n  username: string,\r\n  email: string,\r\n  password: string,\r\n) : Promise<User> {\r\n  const user: User = {username, email, password};\r\n  return API.post<User>('/auth/register', { userAPI })\r\n    .then((response) => handleUserData(response.data))\r\n\r\n  .catch((error) => {\r\n    console.log(error);\r\n  });\r\n}\r\n\r\nfunction logout() {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n  setToken(null);\r\n}\r\n\r\nconst AUTHAPI = {getCurrentUser, login, register, logout}\r\n\r\nexport default AUTHAPI\r\n"]},"metadata":{},"sourceType":"module"}