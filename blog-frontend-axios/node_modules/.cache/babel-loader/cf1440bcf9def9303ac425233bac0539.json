{"ast":null,"code":"import jwtDecode from 'jwt-decode';\nimport TokenService from '../services/api/TokenService';\n\nfunction getSessionDuration(token) {\n  const decoded_jwt = jwtDecode(token);\n  return decoded_jwt.expiresIn;\n}\n\nexport function wasUserActiveDuringCurrentSession(token) {\n  try {\n    const sessionDuration = getSessionDuration(token);\n    const lastResponseTimeStamp = TokenService.getHttpResponseTimeStamp();\n    const lastRequestTime = lastResponseTimeStamp;\n    const current_time = Date.now().valueOf();\n    const lastAccessDelay = current_time - lastRequestTime;\n    return lastAccessDelay < sessionDuration;\n  } catch (_) {\n    return false;\n  }\n}\nexport function getSessionRemainingTimeBeforeExpiration(token) {\n  try {\n    const decoded_jwt = jwtDecode(token);\n    const current_time = Date.now().valueOf();\n    return Math.min(0, decoded_jwt.exp - current_time);\n  } catch (_) {\n    return 0;\n  }\n}\nexport function isAutomaticSessionRenewalRequired(token) {\n  const sessionDuration = getSessionDuration(token);\n  const remainingTime = getSessionRemainingTimeBeforeExpiration(token);\n  return remainingTime < sessionDuration * 0.10 && wasUserActiveDuringCurrentSession(token);\n}","map":{"version":3,"sources":["F:/Documents/Documents/_Nest/nest-react-blog-marc/blog-frontend-axios/src/utils/session.util.ts"],"names":["jwtDecode","TokenService","getSessionDuration","token","decoded_jwt","expiresIn","wasUserActiveDuringCurrentSession","sessionDuration","lastResponseTimeStamp","getHttpResponseTimeStamp","lastRequestTime","current_time","Date","now","valueOf","lastAccessDelay","_","getSessionRemainingTimeBeforeExpiration","Math","min","exp","isAutomaticSessionRenewalRequired","remainingTime"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,YAAtB;AAEA,OAAOC,YAAP,MAAyB,8BAAzB;;AAEA,SAASC,kBAAT,CAA4BC,KAA5B,EAAgD;AAC5C,QAAMC,WAAuB,GAAGJ,SAAS,CAAaG,KAAb,CAAzC;AACA,SAAOC,WAAW,CAACC,SAAnB;AACH;;AAED,OAAO,SAASC,iCAAT,CAA2CH,KAA3C,EAAmE;AACtE,MAAI;AACA,UAAMI,eAAe,GAAGL,kBAAkB,CAACC,KAAD,CAA1C;AACA,UAAMK,qBAAqB,GAAGP,YAAY,CAACQ,wBAAb,EAA9B;AACA,UAAMC,eAAe,GAAGF,qBAAxB;AACA,UAAMG,YAAY,GAAGC,IAAI,CAACC,GAAL,GAAWC,OAAX,EAArB;AACA,UAAMC,eAAe,GAAGJ,YAAY,GAAGD,eAAvC;AACA,WAAOK,eAAe,GAAGR,eAAzB;AACH,GAPD,CAOE,OAAOS,CAAP,EAAU;AACV,WAAO,KAAP;AACD;AACJ;AAED,OAAO,SAASC,uCAAT,CAAiDd,KAAjD,EAAgE;AACnE,MAAI;AACF,UAAMC,WAAuB,GAAGJ,SAAS,CAAaG,KAAb,CAAzC;AACA,UAAMQ,YAAY,GAAGC,IAAI,CAACC,GAAL,GAAWC,OAAX,EAArB;AACA,WAAOI,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYf,WAAW,CAACgB,GAAZ,GAAkBT,YAA9B,CAAP;AACD,GAJD,CAIE,OAAOK,CAAP,EAAU;AACV,WAAO,CAAP;AACD;AACJ;AAED,OAAO,SAASK,iCAAT,CAA2ClB,KAA3C,EAA0D;AAC7D,QAAMI,eAAe,GAAGL,kBAAkB,CAACC,KAAD,CAA1C;AACA,QAAMmB,aAAa,GAAGL,uCAAuC,CAACd,KAAD,CAA7D;AACA,SAAOmB,aAAa,GAAGf,eAAe,GAAG,IAAlC,IAA0CD,iCAAiC,CAACH,KAAD,CAAlF;AACH","sourcesContent":["import jwtDecode from 'jwt-decode';\r\nimport { JWTPayload } from '../types';\r\nimport TokenService from '../services/api/TokenService';\r\n\r\nfunction getSessionDuration(token: any): number {\r\n    const decoded_jwt: JWTPayload = jwtDecode<JWTPayload>(token); \r\n    return decoded_jwt.expiresIn;\r\n}\r\n\r\nexport function wasUserActiveDuringCurrentSession(token: string): boolean {\r\n    try {\r\n        const sessionDuration = getSessionDuration(token);\r\n        const lastResponseTimeStamp = TokenService.getHttpResponseTimeStamp();\r\n        const lastRequestTime = lastResponseTimeStamp;\r\n        const current_time = Date.now().valueOf();\r\n        const lastAccessDelay = current_time - lastRequestTime;\r\n        return lastAccessDelay < sessionDuration;\r\n    } catch (_) {\r\n      return false;\r\n    }\r\n}\r\n\r\nexport function getSessionRemainingTimeBeforeExpiration(token: string) {\r\n    try {\r\n      const decoded_jwt: JWTPayload = jwtDecode<JWTPayload>(token);\r\n      const current_time = Date.now().valueOf();\r\n      return Math.min(0, decoded_jwt.exp - current_time);\r\n    } catch (_) {\r\n      return 0;\r\n    }\r\n}\r\n\r\nexport function isAutomaticSessionRenewalRequired(token: string) {\r\n    const sessionDuration = getSessionDuration(token);\r\n    const remainingTime = getSessionRemainingTimeBeforeExpiration(token);\r\n    return remainingTime < sessionDuration * 0.10 && wasUserActiveDuringCurrentSession(token);\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}